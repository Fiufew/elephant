{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Car List{% endblock title %}

{% block meta_description %}List of cars{% endblock meta_description %}

{% block meta_keywords %}car list, shop, ecommerce{% endblock meta_keywords %}

{% block content %}
<h1 class="mt-4 mb-4">{{car.brand.name}}: {{car.model.name}}</h1>
<div class="table-responsive">
    <table class="table table-striped table-bordered custom-table">
        <thead>
            <tr>
                <th>Бренд</th>
                <th>Модель</th>
                <th>Гос.номер</th>
                <th>Забронирован</th>
                <th>Страховка</th>
                <th>Цена</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            <td>{{ car.brand.name }}</td>
            <td>{{ car.model.name }}</td>
            <td>{{ car.license_plate     }}</td>
            <td>
                {% if car.is_is_availaible %}
                    Да
                {% else %}
                    Нет
                {% endif %}
            </td>
            <td>{{ car.insurance }}</td>
            <td>
                {{ car.price.winter_price }} {{car.price.currency}}
            </td>
            <td>
                <a href="{% url 'backend:car_edit' car.slug %}"><button class="btn btn-primary">Изменить</button></a>
            </td>
        </tbody>
    </table>
</div>
<h2 class="mt-4 mb-4">Список проблем {{car.brand.name}}: {{car.model.name}}</h2>
<div class="problems">
    <ul class="todo-list">
        {% for problem in car.problem_car.all %}
            <li class="todo-item {% if problem.is_solved %}solved{% else %}unsolved{% endif %}">
                <input type="checkbox" {% if problem.is_solved %}checked{% endif %} disabled>
                <span class="issue">{{ problem.issue }}</span>
                <span class="solved-at">{% if problem.is_solved %}Solved at: {{ problem.solved_at }}{% endif %}</span>
                {% if not problem.is_solved %}
                    <button class="solve-button" data-problem-id="{{ problem.id }}">Устранить</button>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
{% endblock content %}

{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
{{ form.media }}
{% endblock extra_js %}
